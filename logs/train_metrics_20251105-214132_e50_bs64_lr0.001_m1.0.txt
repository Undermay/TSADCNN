Epoch 1/50 | Train Loss 0.1004 AP 0.3951 | Val Loss 0.0804 Top1 0.8858 AP(H) 0.4095 AP(G) 0.3446 Diff 0.0649 | P@2 0.9286 P@5 0.6875 P@10 0.5074 P@15 0.3460 P@20 0.2824
Epoch 2/50 | Train Loss 0.0670 AP 0.5473 | Val Loss 0.0625 Top1 0.9264 AP(H) 0.5160 AP(G) 0.4463 Diff 0.0697 | P@2 0.9286 P@5 0.7250 P@10 0.5852 P@15 0.4127 P@20 0.4735
Epoch 3/50 | Train Loss 0.0537 AP 0.7045 | Val Loss 0.0428 Top1 0.9516 AP(H) 0.6970 AP(G) 0.6118 Diff 0.0852 | P@2 1.0000 P@5 0.8375 P@10 0.7741 P@15 0.6444 P@20 0.6265
Epoch 4/50 | Train Loss 0.0438 AP 0.7483 | Val Loss 0.0398 Top1 0.9526 AP(H) 0.7493 AP(G) 0.6602 Diff 0.0891 | P@2 0.8571 P@5 0.9250 P@10 0.8333 P@15 0.6698 P@20 0.7059
Epoch 5/50 | Train Loss 0.0388 AP 0.7537 | Val Loss 0.0368 Top1 0.9613 AP(H) 0.8161 AP(G) 0.7106 Diff 0.1055 | P@2 1.0000 P@5 0.9000 P@10 0.8704 P@15 0.7587 P@20 0.7912
Epoch 6/50 | Train Loss 0.0365 AP 0.7740 | Val Loss 0.0417 Top1 0.9652 AP(H) 0.7986 AP(G) 0.7106 Diff 0.0881 | P@2 1.0000 P@5 0.9375 P@10 0.8704 P@15 0.7270 P@20 0.7588
Epoch 7/50 | Train Loss 0.0343 AP 0.7921 | Val Loss 0.0335 Top1 0.9603 AP(H) 0.7899 AP(G) 0.6902 Diff 0.0997 | P@2 0.9286 P@5 0.9125 P@10 0.8556 P@15 0.7079 P@20 0.7735
Epoch 8/50 | Train Loss 0.0327 AP 0.8072 | Val Loss 0.0307 Top1 0.9700 AP(H) 0.8209 AP(G) 0.7280 Diff 0.0929 | P@2 1.0000 P@5 0.9000 P@10 0.8926 P@15 0.7365 P@20 0.8088
Epoch 9/50 | Train Loss 0.0311 AP 0.8038 | Val Loss 0.0306 Top1 0.9719 AP(H) 0.8015 AP(G) 0.7686 Diff 0.0329 | P@2 1.0000 P@5 0.9250 P@10 0.8667 P@15 0.7238 P@20 0.7765
Epoch 10/50 | Train Loss 0.0307 AP 0.8046 | Val Loss 0.0316 Top1 0.9739 AP(H) 0.8287 AP(G) 0.7483 Diff 0.0803 | P@2 1.0000 P@5 0.9500 P@10 0.8963 P@15 0.7619 P@20 0.7941
Epoch 11/50 | Train Loss 0.0297 AP 0.8212 | Val Loss 0.0288 Top1 0.9748 AP(H) 0.8238 AP(G) 0.7551 Diff 0.0687 | P@2 1.0000 P@5 0.9125 P@10 0.8778 P@15 0.7683 P@20 0.7971
Epoch 12/50 | Train Loss 0.0296 AP 0.8231 | Val Loss 0.0281 Top1 0.9739 AP(H) 0.8238 AP(G) 0.7493 Diff 0.0745 | P@2 1.0000 P@5 0.9750 P@10 0.8778 P@15 0.7651 P@20 0.7853
Epoch 13/50 | Train Loss 0.0283 AP 0.8216 | Val Loss 0.0290 Top1 0.9671 AP(H) 0.8228 AP(G) 0.7628 Diff 0.0600 | P@2 0.9286 P@5 0.9500 P@10 0.8815 P@15 0.8127 P@20 0.7471
Epoch 14/50 | Train Loss 0.0285 AP 0.8253 | Val Loss 0.0295 Top1 0.9758 AP(H) 0.8219 AP(G) 0.7444 Diff 0.0774 | P@2 1.0000 P@5 0.9125 P@10 0.8889 P@15 0.7714 P@20 0.7794
Epoch 15/50 | Train Loss 0.0279 AP 0.8296 | Val Loss 0.0284 Top1 0.9748 AP(H) 0.8161 AP(G) 0.7667 Diff 0.0494 | P@2 1.0000 P@5 0.8875 P@10 0.8556 P@15 0.8159 P@20 0.7529
Epoch 16/50 | Train Loss 0.0266 AP 0.8171 | Val Loss 0.0292 Top1 0.9690 AP(H) 0.8180 AP(G) 0.7473 Diff 0.0707 | P@2 1.0000 P@5 0.9375 P@10 0.8741 P@15 0.7587 P@20 0.7853
Epoch 17/50 | Train Loss 0.0270 AP 0.8215 | Val Loss 0.0281 Top1 0.9690 AP(H) 0.7957 AP(G) 0.7309 Diff 0.0649 | P@2 1.0000 P@5 0.8875 P@10 0.8667 P@15 0.7587 P@20 0.7353
Epoch 18/50 | Train Loss 0.0261 AP 0.8400 | Val Loss 0.0263 Top1 0.9748 AP(H) 0.8238 AP(G) 0.7725 Diff 0.0513 | P@2 1.0000 P@5 0.9000 P@10 0.8630 P@15 0.7524 P@20 0.8265
Epoch 19/50 | Train Loss 0.0260 AP 0.8369 | Val Loss 0.0249 Top1 0.9768 AP(H) 0.8335 AP(G) 0.7812 Diff 0.0523 | P@2 1.0000 P@5 0.9125 P@10 0.8963 P@15 0.7746 P@20 0.8059
Epoch 20/50 | Train Loss 0.0262 AP 0.8322 | Val Loss 0.0304 Top1 0.9642 AP(H) 0.8306 AP(G) 0.7580 Diff 0.0726 | P@2 0.9286 P@5 0.9375 P@10 0.9074 P@15 0.7492 P@20 0.8118
Epoch 21/50 | Train Loss 0.0251 AP 0.8430 | Val Loss 0.0263 Top1 0.9777 AP(H) 0.8403 AP(G) 0.7744 Diff 0.0658 | P@2 1.0000 P@5 0.9125 P@10 0.8741 P@15 0.7810 P@20 0.8382
Epoch 22/50 | Train Loss 0.0255 AP 0.8300 | Val Loss 0.0284 Top1 0.9719 AP(H) 0.8074 AP(G) 0.7744 Diff 0.0329 | P@2 0.8571 P@5 0.9125 P@10 0.8778 P@15 0.7524 P@20 0.7735
Epoch 23/50 | Train Loss 0.0242 AP 0.8197 | Val Loss 0.0263 Top1 0.9710 AP(H) 0.8199 AP(G) 0.7744 Diff 0.0455 | P@2 0.9286 P@5 0.9000 P@10 0.9037 P@15 0.7587 P@20 0.7824
Epoch 24/50 | Train Loss 0.0249 AP 0.8287 | Val Loss 0.0274 Top1 0.9719 AP(H) 0.8316 AP(G) 0.7909 Diff 0.0407 | P@2 0.9286 P@5 0.9625 P@10 0.9185 P@15 0.7302 P@20 0.8176
Epoch 25/50 | Train Loss 0.0242 AP 0.8431 | Val Loss 0.0260 Top1 0.9748 AP(H) 0.8335 AP(G) 0.7899 Diff 0.0436 | P@2 1.0000 P@5 0.8875 P@10 0.9111 P@15 0.7492 P@20 0.8235
Epoch 26/50 | Train Loss 0.0241 AP 0.8430 | Val Loss 0.0246 Top1 0.9758 AP(H) 0.8287 AP(G) 0.7928 Diff 0.0358 | P@2 0.9286 P@5 0.9625 P@10 0.8815 P@15 0.7651 P@20 0.8059
Epoch 27/50 | Train Loss 0.0232 AP 0.8390 | Val Loss 0.0254 Top1 0.9729 AP(H) 0.8209 AP(G) 0.7861 Diff 0.0348 | P@2 1.0000 P@5 0.9000 P@10 0.8815 P@15 0.7714 P@20 0.7853
Epoch 28/50 | Train Loss 0.0236 AP 0.8559 | Val Loss 0.0235 Top1 0.9826 AP(H) 0.8441 AP(G) 0.7938 Diff 0.0503 | P@2 1.0000 P@5 0.9250 P@10 0.9000 P@15 0.7905 P@20 0.8176
Epoch 29/50 | Train Loss 0.0230 AP 0.8506 | Val Loss 0.0233 Top1 0.9826 AP(H) 0.8345 AP(G) 0.7870 Diff 0.0474 | P@2 1.0000 P@5 0.9500 P@10 0.8778 P@15 0.7937 P@20 0.7971
Epoch 30/50 | Train Loss 0.0231 AP 0.8505 | Val Loss 0.0249 Top1 0.9768 AP(H) 0.8596 AP(G) 0.7861 Diff 0.0736 | P@2 1.0000 P@5 0.9500 P@10 0.9185 P@15 0.8127 P@20 0.8235
Epoch 31/50 | Train Loss 0.0229 AP 0.8508 | Val Loss 0.0239 Top1 0.9787 AP(H) 0.8354 AP(G) 0.8054 Diff 0.0300 | P@2 0.9286 P@5 0.9500 P@10 0.9148 P@15 0.7714 P@20 0.7971
Epoch 32/50 | Train Loss 0.0225 AP 0.8511 | Val Loss 0.0221 Top1 0.9826 AP(H) 0.8461 AP(G) 0.7948 Diff 0.0513 | P@2 1.0000 P@5 0.9750 P@10 0.8889 P@15 0.8000 P@20 0.8118
Epoch 33/50 | Train Loss 0.0227 AP 0.8257 | Val Loss 0.0236 Top1 0.9797 AP(H) 0.8238 AP(G) 0.7628 Diff 0.0610 | P@2 1.0000 P@5 0.9250 P@10 0.8630 P@15 0.7683 P@20 0.8059
Epoch 34/50 | Train Loss 0.0223 AP 0.8541 | Val Loss 0.0233 Top1 0.9806 AP(H) 0.8587 AP(G) 0.8112 Diff 0.0474 | P@2 1.0000 P@5 0.9750 P@10 0.9556 P@15 0.7746 P@20 0.8206
Epoch 35/50 | Train Loss 0.0218 AP 0.8363 | Val Loss 0.0232 Top1 0.9787 AP(H) 0.8296 AP(G) 0.7948 Diff 0.0348 | P@2 1.0000 P@5 0.9500 P@10 0.8667 P@15 0.7683 P@20 0.8147
Epoch 36/50 | Train Loss 0.0222 AP 0.8549 | Val Loss 0.0220 Top1 0.9806 AP(H) 0.8412 AP(G) 0.7909 Diff 0.0503 | P@2 1.0000 P@5 0.9750 P@10 0.8926 P@15 0.7587 P@20 0.8324
Epoch 37/50 | Train Loss 0.0219 AP 0.8590 | Val Loss 0.0223 Top1 0.9874 AP(H) 0.8480 AP(G) 0.8161 Diff 0.0319 | P@2 1.0000 P@5 0.9750 P@10 0.9111 P@15 0.7714 P@20 0.8265
Epoch 38/50 | Train Loss 0.0213 AP 0.8528 | Val Loss 0.0224 Top1 0.9835 AP(H) 0.8432 AP(G) 0.7812 Diff 0.0620 | P@2 1.0000 P@5 0.9500 P@10 0.9185 P@15 0.7778 P@20 0.8059
Epoch 39/50 | Train Loss 0.0216 AP 0.8434 | Val Loss 0.0213 Top1 0.9855 AP(H) 0.8558 AP(G) 0.7832 Diff 0.0726 | P@2 1.0000 P@5 0.9250 P@10 0.9148 P@15 0.8286 P@20 0.8059
Epoch 40/50 | Train Loss 0.0215 AP 0.8537 | Val Loss 0.0227 Top1 0.9806 AP(H) 0.8238 AP(G) 0.7754 Diff 0.0484 | P@2 1.0000 P@5 0.9000 P@10 0.9148 P@15 0.7460 P@20 0.7912
Epoch 41/50 | Train Loss 0.0210 AP 0.8592 | Val Loss 0.0216 Top1 0.9826 AP(H) 0.8509 AP(G) 0.7948 Diff 0.0561 | P@2 1.0000 P@5 1.0000 P@10 0.8815 P@15 0.7746 P@20 0.8500
Epoch 42/50 | Train Loss 0.0213 AP 0.8509 | Val Loss 0.0238 Top1 0.9758 AP(H) 0.8441 AP(G) 0.7793 Diff 0.0649 | P@2 0.9286 P@5 0.9375 P@10 0.9000 P@15 0.8063 P@20 0.8059
Epoch 43/50 | Train Loss 0.0217 AP 0.8366 | Val Loss 0.0231 Top1 0.9816 AP(H) 0.8432 AP(G) 0.7754 Diff 0.0678 | P@2 1.0000 P@5 1.0000 P@10 0.9074 P@15 0.7079 P@20 0.8676
Epoch 44/50 | Train Loss 0.0210 AP 0.8496 | Val Loss 0.0222 Top1 0.9758 AP(H) 0.8441 AP(G) 0.8054 Diff 0.0387 | P@2 1.0000 P@5 0.9250 P@10 0.9000 P@15 0.7905 P@20 0.8176
Epoch 45/50 | Train Loss 0.0207 AP 0.8664 | Val Loss 0.0217 Top1 0.9864 AP(H) 0.8470 AP(G) 0.8025 Diff 0.0445 | P@2 1.0000 P@5 1.0000 P@10 0.9037 P@15 0.7714 P@20 0.8235
Epoch 46/50 | Train Loss 0.0210 AP 0.8584 | Val Loss 0.0234 Top1 0.9787 AP(H) 0.8490 AP(G) 0.7773 Diff 0.0716 | P@2 1.0000 P@5 0.9625 P@10 0.8778 P@15 0.7968 P@20 0.8353
Epoch 47/50 | Train Loss 0.0207 AP 0.8486 | Val Loss 0.0219 Top1 0.9758 AP(H) 0.8441 AP(G) 0.8074 Diff 0.0368 | P@2 0.9286 P@5 0.9250 P@10 0.9111 P@15 0.7810 P@20 0.8235
Epoch 48/50 | Train Loss 0.0205 AP 0.8661 | Val Loss 0.0220 Top1 0.9845 AP(H) 0.8432 AP(G) 0.7996 Diff 0.0436 | P@2 1.0000 P@5 0.9750 P@10 0.8963 P@15 0.7937 P@20 0.8029
Epoch 49/50 | Train Loss 0.0204 AP 0.8470 | Val Loss 0.0229 Top1 0.9826 AP(H) 0.8296 AP(G) 0.7899 Diff 0.0397 | P@2 1.0000 P@5 0.9500 P@10 0.8963 P@15 0.7556 P@20 0.8029
Epoch 50/50 | Train Loss 0.0203 AP 0.8639 | Val Loss 0.0217 Top1 0.9845 AP(H) 0.8461 AP(G) 0.8093 Diff 0.0368 | P@2 1.0000 P@5 1.0000 P@10 0.9074 P@15 0.7619 P@20 0.8265

Run Config
epochs=50
batch_size=64
lr=0.001
weight_decay=0.0001
margin=1.0
num_workers=2
train_path=data/train_trajectories.npy
test_path=data/test_trajectories.npy
device=cuda
model.feature_dim=6
model.hidden_dim=128
model.num_layers=2
model.conv_channels=32
model.embed_dim=32
model.dropout=0.1
--- end ---
