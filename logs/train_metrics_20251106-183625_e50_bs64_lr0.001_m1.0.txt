Epoch 1/50 | Train Loss 0.1002 AP 0.4162 | Val Loss 0.0798 Top1 0.8490 AP(H) 0.3950 AP(G) 0.3388 Diff 0.0561 | P@2 0.7143 P@5 0.6625 P@10 0.4519 P@15 0.3619 P@20 0.2912
Epoch 2/50 | Train Loss 0.0639 AP 0.5709 | Val Loss 0.0548 Top1 0.9226 AP(H) 0.5653 AP(G) 0.4879 Diff 0.0774 | P@2 0.9286 P@5 0.8125 P@10 0.6074 P@15 0.5016 P@20 0.5029
Epoch 3/50 | Train Loss 0.0544 AP 0.6188 | Val Loss 0.0536 Top1 0.9342 AP(H) 0.6031 AP(G) 0.4773 Diff 0.1258 | P@2 0.9286 P@5 0.9125 P@10 0.6889 P@15 0.6095 P@20 0.4294
Epoch 4/50 | Train Loss 0.0485 AP 0.6778 | Val Loss 0.0452 Top1 0.9564 AP(H) 0.6612 AP(G) 0.5692 Diff 0.0920 | P@2 0.9286 P@5 0.8625 P@10 0.7444 P@15 0.6095 P@20 0.5735
Epoch 5/50 | Train Loss 0.0425 AP 0.7372 | Val Loss 0.0405 Top1 0.9555 AP(H) 0.6980 AP(G) 0.6467 Diff 0.0513 | P@2 1.0000 P@5 0.8125 P@10 0.7630 P@15 0.6603 P@20 0.6294
Epoch 6/50 | Train Loss 0.0390 AP 0.7455 | Val Loss 0.0353 Top1 0.9632 AP(H) 0.7406 AP(G) 0.6350 Diff 0.1055 | P@2 1.0000 P@5 0.8125 P@10 0.8148 P@15 0.7492 P@20 0.6353
Epoch 7/50 | Train Loss 0.0368 AP 0.7742 | Val Loss 0.0436 Top1 0.9622 AP(H) 0.7619 AP(G) 0.6893 Diff 0.0726 | P@2 0.9286 P@5 0.9125 P@10 0.7926 P@15 0.7619 P@20 0.6882
Epoch 8/50 | Train Loss 0.0348 AP 0.7784 | Val Loss 0.0331 Top1 0.9700 AP(H) 0.7822 AP(G) 0.7057 Diff 0.0765 | P@2 1.0000 P@5 0.9375 P@10 0.8556 P@15 0.7270 P@20 0.7206
Epoch 9/50 | Train Loss 0.0342 AP 0.7854 | Val Loss 0.0326 Top1 0.9642 AP(H) 0.7715 AP(G) 0.7106 Diff 0.0610 | P@2 1.0000 P@5 0.8625 P@10 0.8333 P@15 0.7333 P@20 0.7176
Epoch 10/50 | Train Loss 0.0330 AP 0.7828 | Val Loss 0.0344 Top1 0.9622 AP(H) 0.7764 AP(G) 0.6893 Diff 0.0871 | P@2 0.9286 P@5 0.9250 P@10 0.8000 P@15 0.7397 P@20 0.7441
Epoch 11/50 | Train Loss 0.0325 AP 0.8039 | Val Loss 0.0337 Top1 0.9642 AP(H) 0.7890 AP(G) 0.7222 Diff 0.0668 | P@2 0.9286 P@5 0.9500 P@10 0.8259 P@15 0.7810 P@20 0.7176
Epoch 12/50 | Train Loss 0.0312 AP 0.8070 | Val Loss 0.0319 Top1 0.9729 AP(H) 0.8403 AP(G) 0.7628 Diff 0.0774 | P@2 1.0000 P@5 0.9750 P@10 0.9074 P@15 0.7746 P@20 0.8029
Epoch 13/50 | Train Loss 0.0301 AP 0.8047 | Val Loss 0.0307 Top1 0.9700 AP(H) 0.8122 AP(G) 0.7464 Diff 0.0658 | P@2 1.0000 P@5 0.9250 P@10 0.8556 P@15 0.7619 P@20 0.7824
Epoch 14/50 | Train Loss 0.0294 AP 0.8019 | Val Loss 0.0286 Top1 0.9632 AP(H) 0.7909 AP(G) 0.7435 Diff 0.0474 | P@2 1.0000 P@5 0.9250 P@10 0.8370 P@15 0.7429 P@20 0.7500
Epoch 15/50 | Train Loss 0.0288 AP 0.8121 | Val Loss 0.0315 Top1 0.9652 AP(H) 0.8025 AP(G) 0.7280 Diff 0.0745 | P@2 1.0000 P@5 0.8875 P@10 0.8630 P@15 0.7556 P@20 0.7618
Epoch 16/50 | Train Loss 0.0282 AP 0.8172 | Val Loss 0.0263 Top1 0.9748 AP(H) 0.8170 AP(G) 0.7541 Diff 0.0629 | P@2 1.0000 P@5 0.9125 P@10 0.8741 P@15 0.7778 P@20 0.7706
Epoch 17/50 | Train Loss 0.0276 AP 0.8169 | Val Loss 0.0278 Top1 0.9739 AP(H) 0.8345 AP(G) 0.7580 Diff 0.0765 | P@2 1.0000 P@5 0.8750 P@10 0.8852 P@15 0.7905 P@20 0.8118
Epoch 18/50 | Train Loss 0.0276 AP 0.8186 | Val Loss 0.0284 Top1 0.9661 AP(H) 0.7986 AP(G) 0.7386 Diff 0.0600 | P@2 0.8571 P@5 0.9500 P@10 0.8704 P@15 0.7365 P@20 0.7588
Epoch 19/50 | Train Loss 0.0270 AP 0.8170 | Val Loss 0.0258 Top1 0.9758 AP(H) 0.8025 AP(G) 0.7599 Diff 0.0426 | P@2 0.9286 P@5 0.8750 P@10 0.8852 P@15 0.7365 P@20 0.7706
Epoch 20/50 | Train Loss 0.0276 AP 0.8354 | Val Loss 0.0266 Top1 0.9758 AP(H) 0.8335 AP(G) 0.7870 Diff 0.0465 | P@2 1.0000 P@5 0.9250 P@10 0.9148 P@15 0.7841 P@20 0.7794
Epoch 21/50 | Train Loss 0.0260 AP 0.8205 | Val Loss 0.0283 Top1 0.9681 AP(H) 0.8277 AP(G) 0.7522 Diff 0.0755 | P@2 1.0000 P@5 0.9250 P@10 0.8852 P@15 0.7905 P@20 0.7794
Epoch 22/50 | Train Loss 0.0269 AP 0.8268 | Val Loss 0.0280 Top1 0.9729 AP(H) 0.8432 AP(G) 0.7638 Diff 0.0794 | P@2 0.9286 P@5 0.9000 P@10 0.9111 P@15 0.7968 P@20 0.8118
Epoch 23/50 | Train Loss 0.0259 AP 0.8222 | Val Loss 0.0255 Top1 0.9739 AP(H) 0.8170 AP(G) 0.7406 Diff 0.0765 | P@2 1.0000 P@5 0.9125 P@10 0.8926 P@15 0.7683 P@20 0.7647
Epoch 24/50 | Train Loss 0.0260 AP 0.8190 | Val Loss 0.0290 Top1 0.9739 AP(H) 0.7928 AP(G) 0.7164 Diff 0.0765 | P@2 0.9286 P@5 0.8625 P@10 0.8593 P@15 0.7651 P@20 0.7382
Epoch 25/50 | Train Loss 0.0251 AP 0.8186 | Val Loss 0.0268 Top1 0.9739 AP(H) 0.8180 AP(G) 0.7657 Diff 0.0523 | P@2 1.0000 P@5 0.9250 P@10 0.9111 P@15 0.7683 P@20 0.7500
Epoch 26/50 | Train Loss 0.0255 AP 0.8225 | Val Loss 0.0254 Top1 0.9758 AP(H) 0.8093 AP(G) 0.7522 Diff 0.0571 | P@2 1.0000 P@5 0.8750 P@10 0.9074 P@15 0.7492 P@20 0.7559
Epoch 27/50 | Train Loss 0.0256 AP 0.8346 | Val Loss 0.0252 Top1 0.9797 AP(H) 0.8393 AP(G) 0.7677 Diff 0.0716 | P@2 1.0000 P@5 0.9250 P@10 0.9111 P@15 0.8190 P@20 0.7676
Epoch 28/50 | Train Loss 0.0253 AP 0.8336 | Val Loss 0.0259 Top1 0.9739 AP(H) 0.8054 AP(G) 0.7512 Diff 0.0542 | P@2 1.0000 P@5 0.9000 P@10 0.8630 P@15 0.7810 P@20 0.7441
Epoch 29/50 | Train Loss 0.0246 AP 0.8355 | Val Loss 0.0248 Top1 0.9797 AP(H) 0.8451 AP(G) 0.7561 Diff 0.0891 | P@2 0.9286 P@5 0.9250 P@10 0.9185 P@15 0.8095 P@20 0.7941
Epoch 30/50 | Train Loss 0.0243 AP 0.8447 | Val Loss 0.0246 Top1 0.9797 AP(H) 0.8470 AP(G) 0.7638 Diff 0.0833 | P@2 1.0000 P@5 0.9750 P@10 0.9000 P@15 0.8159 P@20 0.7912
Epoch 31/50 | Train Loss 0.0244 AP 0.8461 | Val Loss 0.0230 Top1 0.9758 AP(H) 0.8258 AP(G) 0.7899 Diff 0.0358 | P@2 1.0000 P@5 0.9000 P@10 0.9111 P@15 0.7619 P@20 0.7853
Epoch 32/50 | Train Loss 0.0245 AP 0.8281 | Val Loss 0.0260 Top1 0.9729 AP(H) 0.8112 AP(G) 0.7609 Diff 0.0503 | P@2 1.0000 P@5 0.9000 P@10 0.8704 P@15 0.7746 P@20 0.7618
Epoch 33/50 | Train Loss 0.0237 AP 0.8196 | Val Loss 0.0260 Top1 0.9681 AP(H) 0.8316 AP(G) 0.7464 Diff 0.0852 | P@2 1.0000 P@5 0.9250 P@10 0.8704 P@15 0.7810 P@20 0.8118
Epoch 34/50 | Train Loss 0.0240 AP 0.8429 | Val Loss 0.0262 Top1 0.9777 AP(H) 0.8519 AP(G) 0.7996 Diff 0.0523 | P@2 1.0000 P@5 0.9750 P@10 0.9148 P@15 0.7810 P@20 0.8265
Epoch 35/50 | Train Loss 0.0239 AP 0.8363 | Val Loss 0.0238 Top1 0.9806 AP(H) 0.8403 AP(G) 0.7977 Diff 0.0426 | P@2 1.0000 P@5 0.9000 P@10 0.8926 P@15 0.8317 P@20 0.7794
Epoch 36/50 | Train Loss 0.0236 AP 0.8514 | Val Loss 0.0224 Top1 0.9768 AP(H) 0.8441 AP(G) 0.7657 Diff 0.0784 | P@2 1.0000 P@5 0.9750 P@10 0.9222 P@15 0.7968 P@20 0.7824
Epoch 37/50 | Train Loss 0.0235 AP 0.8308 | Val Loss 0.0231 Top1 0.9806 AP(H) 0.8277 AP(G) 0.7783 Diff 0.0494 | P@2 1.0000 P@5 0.9250 P@10 0.9074 P@15 0.7778 P@20 0.7735
Epoch 38/50 | Train Loss 0.0232 AP 0.8406 | Val Loss 0.0232 Top1 0.9806 AP(H) 0.8654 AP(G) 0.7812 Diff 0.0842 | P@2 1.0000 P@5 0.9750 P@10 0.9333 P@15 0.8476 P@20 0.7912
Epoch 39/50 | Train Loss 0.0235 AP 0.8480 | Val Loss 0.0230 Top1 0.9787 AP(H) 0.8228 AP(G) 0.7919 Diff 0.0310 | P@2 1.0000 P@5 0.9750 P@10 0.8852 P@15 0.7778 P@20 0.7647
Epoch 40/50 | Train Loss 0.0233 AP 0.8314 | Val Loss 0.0216 Top1 0.9855 AP(H) 0.8345 AP(G) 0.7783 Diff 0.0561 | P@2 1.0000 P@5 0.9250 P@10 0.9296 P@15 0.7778 P@20 0.7765
Epoch 41/50 | Train Loss 0.0226 AP 0.8470 | Val Loss 0.0215 Top1 0.9845 AP(H) 0.8141 AP(G) 0.8083 Diff 0.0058 | P@2 1.0000 P@5 0.9500 P@10 0.9074 P@15 0.7746 P@20 0.7294
Epoch 42/50 | Train Loss 0.0224 AP 0.8514 | Val Loss 0.0227 Top1 0.9787 AP(H) 0.8441 AP(G) 0.7764 Diff 0.0678 | P@2 1.0000 P@5 0.9000 P@10 0.9481 P@15 0.7683 P@20 0.8059
Epoch 43/50 | Train Loss 0.0229 AP 0.8473 | Val Loss 0.0214 Top1 0.9826 AP(H) 0.8403 AP(G) 0.8054 Diff 0.0348 | P@2 1.0000 P@5 0.9250 P@10 0.9222 P@15 0.7968 P@20 0.7824
Epoch 44/50 | Train Loss 0.0225 AP 0.8519 | Val Loss 0.0217 Top1 0.9855 AP(H) 0.8432 AP(G) 0.7996 Diff 0.0436 | P@2 1.0000 P@5 0.9000 P@10 0.9185 P@15 0.7905 P@20 0.8059
Epoch 45/50 | Train Loss 0.0229 AP 0.8487 | Val Loss 0.0223 Top1 0.9787 AP(H) 0.8441 AP(G) 0.7696 Diff 0.0745 | P@2 1.0000 P@5 0.9250 P@10 0.9111 P@15 0.8063 P@20 0.7941
Epoch 46/50 | Train Loss 0.0226 AP 0.8550 | Val Loss 0.0213 Top1 0.9855 AP(H) 0.8577 AP(G) 0.8296 Diff 0.0281 | P@2 1.0000 P@5 1.0000 P@10 0.9148 P@15 0.8317 P@20 0.7912
Epoch 47/50 | Train Loss 0.0223 AP 0.8590 | Val Loss 0.0214 Top1 0.9894 AP(H) 0.8422 AP(G) 0.7861 Diff 0.0561 | P@2 1.0000 P@5 0.9000 P@10 0.9148 P@15 0.7937 P@20 0.8029
Epoch 48/50 | Train Loss 0.0218 AP 0.8299 | Val Loss 0.0226 Top1 0.9826 AP(H) 0.8335 AP(G) 0.7657 Diff 0.0678 | P@2 1.0000 P@5 0.9000 P@10 0.8852 P@15 0.7968 P@20 0.7971
Epoch 49/50 | Train Loss 0.0221 AP 0.8594 | Val Loss 0.0209 Top1 0.9768 AP(H) 0.8577 AP(G) 0.7880 Diff 0.0697 | P@2 1.0000 P@5 0.9500 P@10 0.9074 P@15 0.8349 P@20 0.8059
Epoch 50/50 | Train Loss 0.0222 AP 0.8520 | Val Loss 0.0207 Top1 0.9884 AP(H) 0.8403 AP(G) 0.8141 Diff 0.0261 | P@2 1.0000 P@5 0.9750 P@10 0.9333 P@15 0.7746 P@20 0.7824

Run Config
epochs=50
batch_size=64
lr=0.001
weight_decay=0.0001
margin=1.0
num_workers=2
train_path=data/train_trajectories.npy
test_path=data/test_trajectories.npy
device=cuda
model.feature_dim=6
model.hidden_dim=128
model.num_layers=2
model.conv_channels=32
model.embed_dim=32
model.dropout=0.1
--- end ---
